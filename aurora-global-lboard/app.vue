<template>
  <div>
    <div class="leaderboard-global"> 
      <div class="join-room__cb">
        <svg width="225" height="132" viewBox="0 0 75 44" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M55.1766 40.722C56.7697 41.3499 57.3824 41.7267 57.3824 42.1035C57.1373 43.1082 51.6227 43.1082 49.5395 42.1035C46.3532 40.4708 41.5739 27.786 41.2063 24.0182C38.8779 25.7765 36.9172 26.6557 35.2015 27.0324C31.4026 27.9116 28.8291 26.5301 26.1331 27.2836C24.4174 27.6604 22.7018 28.9163 20.6185 31.9305C23.9272 31.3026 26.6232 31.0514 28.8291 31.0514C27.9713 33.0609 27.6036 34.8191 27.6036 36.2007C27.4811 40.3452 30.1771 42.6059 32.628 43.2338C34.3437 43.7362 36.0593 43.2338 36.1819 42.1035C35.9368 41.0988 34.9564 40.5964 33.2408 40.3452C33.976 37.959 35.079 35.8239 36.427 34.0656C38.0201 32.1817 39.8583 30.6746 42.0641 29.9211C43.4121 35.6983 46.4758 42.857 49.1718 43.485C52.358 44.2386 59.0981 44.3641 58.9755 42.4803C58.3628 41.3499 57.1373 40.5964 55.1766 40.722Z" fill="#E6C300"></path> <path d="M21.1086 40.8476C21.2312 41.2243 21.2312 41.4755 20.9861 41.7267C20.3734 42.6059 18.1675 42.9826 16.0842 42.9826C13.2657 42.9826 10.5696 42.2291 11.3049 40.722C12.0402 36.5774 11.6726 32.5585 10.202 28.6651C9.22163 26.0277 7.75107 23.2647 5.91287 20.6272C5.54523 23.1391 5.79033 25.3997 6.40306 27.158C4.19722 28.5395 2.60411 30.0466 1.62374 31.4282C-0.704643 34.568 -0.214457 37.4566 1.13356 39.5916C3.0943 42.6059 6.7707 44.113 7.38343 42.9826C7.62852 42.4803 7.26088 41.6011 6.03542 39.9684C5.66778 38.8381 7.99616 35.9495 10.6922 34.4424C10.9373 36.9542 10.9373 39.2149 10.202 41.4755C10.0795 42.857 13.0206 43.6106 15.8391 43.7362C18.4126 43.8618 21.1086 43.485 21.7214 42.4803C21.9665 41.9779 21.8439 41.4755 21.1086 40.8476Z" fill="#E6C300"></path> <path d="M55.2991 7.31448C55.5442 6.30975 55.5442 5.93297 56.2795 5.17942C57.1373 4.42586 57.1373 4.42586 58.1177 4.04909C57.0148 3.7979 55.7893 1.78843 54.6864 3.42113C54.9315 3.16994 54.809 3.29554 54.6864 3.42113C54.6864 3.54672 54.6864 3.54672 54.6864 3.42113C53.706 4.92823 55.5442 6.18415 55.2991 7.31448Z" fill="#E6C300"></path> <path d="M73.6811 4.42586C73.1909 3.29554 71.5978 3.16994 70.6175 2.79317C68.6567 2.2908 67.3087 1.16047 65.4705 0.53251C64 0.0301421 62.2843 0.783695 60.8137 0.406918C59.3432 0.0301421 59.5883 -0.221042 58.1177 0.281326C57.3824 0.53251 56.157 1.16047 55.1766 1.41166C52.6031 2.03962 51.3777 3.42113 48.9267 4.55146C46.1082 5.05382 43.9023 5.68179 43.9023 5.80738C41.6965 5.55619 39.3681 5.80738 37.775 6.18415C32.2604 4.17468 25.1527 3.67231 20.741 4.30027C15.4715 5.05383 11.0598 7.56567 7.38343 11.7102C11.4275 8.06804 15.8391 6.05856 20.6185 5.4306C25.1527 4.80264 31.8927 5.30501 37.0397 7.44007C39.3681 6.81211 42.0641 6.56093 44.3925 6.93771C44.3925 6.93771 46.7209 6.05856 48.8042 5.80738C48.8042 5.80738 48.8042 5.80738 48.9267 5.80738C50.1522 5.30501 51.8678 3.67231 52.7257 3.29554C54.6864 2.54198 56.7697 2.16521 58.7305 1.66284C59.0981 1.53725 58.853 1.16047 59.4657 1.03488C59.5883 1.03488 59.8334 1.53725 60.0785 1.53725C61.9167 1.66284 64.245 1.03488 65.9607 1.91402C67.7989 2.79317 69.392 3.42113 71.3527 4.17468C70.0047 5.80738 72.4557 5.4306 72.088 6.81211C71.8429 7.56567 70.9851 8.5704 70.9851 8.5704C70.4949 9.57514 68.1665 9.70073 67.3087 10.0775C65.8382 10.7055 56.0344 17.7386 54.809 18.6178C53.9511 19.1201 52.9708 19.7481 51.8678 20.3761C51.8678 20.3761 53.0933 19.7481 55.4217 18.6178C55.4217 18.6178 55.5442 18.6178 55.5442 18.4922C57.6275 17.2363 60.5687 15.478 62.0392 14.4732C63.8774 13.2173 65.7156 11.7102 67.9214 10.8311C69.6371 10.2031 70.74 10.2031 72.088 8.696C72.5782 8.06804 74.0488 5.4306 73.6811 4.42586Z" fill="#E6C300"></path></svg>
      </div>

      <h1 class="leaderboard-global__title">Global Leaderboard</h1>
    </div>

    <div class="leaderboard-global__results">
      <p v-for="(entry, index) in leaderboard.entries.reverse()" :key="entry.position" class="leaderboard-global__entry cb-black">
        <div class="leaderboard-global__details">
          <span class="leaderboard-global__entry-position cb-yellow--bg"> {{ index + 1 }} </span>
          <span class="leaderboard-global__entry-name"> {{ entry.name }} </span>
        </div>
        <span class="leaderboard-global__entry-score cb-yellow--bg"> {{ entry.score }} </span>
      </p>
    </div>
  </div>
</template>

<script lang="ts" setup>
import { ref, onMounted } from "vue";

type LeaderboardEntry = {
  name: string;
  score: number;
  position: number;
};

type Leaderboard = {
  entries: LeaderboardEntry[];
};

const runtimeConfig = useRuntimeConfig();

let leaderboard = ref<Leaderboard>({ entries: [] });

async function useFetch(url: string) {
  const response = await fetch(url);
  return await response.json();
}

onMounted(async () => {
  const response = await useFetch(
    `${runtimeConfig.public.apiBase}/api/globalleaderboard`
  );
  leaderboard.value = response;
});
</script>

<style lang="scss">
  html {
    font-family: 'Montserrat', sans-serif;
    font-size: large;

    &:has(.leaderboard-global) {
      background-color: rgb(54, 54, 54);
    }
  }
  
  body {
    margin: 0;
    padding: 0;
  }

.leaderboard-global{
    display: flex;
    color: white;
    background: rgb(54, 54, 54);
    margin: 0;
    border-bottom: 4px solid #e6c300;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 20px;
    position: sticky;
    top: 0;
    z-index: 1000;

  &__entry {
    background-color: white;
    margin: 0;
    padding: 10px;
    border-radius: 50px;
    display: flex;
    justify-content: space-between;
    align-items: center;

    &-position {
      padding: 10px;
      border-radius: 100%;
      width: 18px;
      height: 18px;
      text-align: center;
      line-height: 18px;
      font-weight: bolder;
    }

    &-score {
      padding: 10px;
      border-radius: 50px;
      width: min-content;
      height: 18px;
      text-align: center;
      line-height: 18px;
      font-weight: bolder;
    }

    &-name {
      line-height: 40px;
      text-align: center;
    }
  }

  &__details {
    display: flex;
    gap: 20px;
    width: fit-content;
  }

  &__results {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: 10px;
    
    background: rgb(54, 54, 54)
  }

  &__title {
    margin: 0;
    padding-top: 16px;
  }
}

.cb {
  &-black {
    color: #171717;
  }

  &-yellow {
    color: #e6c300;

    &--bg {
      background-color: #e6c300;
    }
  }
}
</style>
